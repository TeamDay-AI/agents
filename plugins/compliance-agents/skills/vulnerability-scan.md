# Vulnerability Scan Skill

Execute the Vulnerability Scanner Agent to check for security vulnerabilities.

## When to Use

- User says "scan for vulnerabilities"
- User says "check security"
- User says "run security scan"
- Weekly (every Monday)

## Instructions

1. **Read the agent instructions**:
   - Read `packages/agents/vulnerability-scanner/README.md`

2. **Run dependency scan**:
   ```bash
   cd packages/app && bun outdated
   cd packages/computer && bun outdated
   cd packages/pulse && bun outdated
   ```
   - Check for packages with known vulnerabilities
   - Prioritize: Critical > High > Medium > Low

3. **Check Firestore security rules**:
   - Read `packages/app/firestore.rules`
   - Look for common mistakes:
     - `allow read, write: if true;` (overly permissive)
     - Missing authentication checks
     - Missing organization isolation
     - Insecure data access patterns

4. **Scan for secrets in code**:
   ```bash
   grep -r "api_key\|apiKey\|API_KEY\|secret\|password\|token" packages --include="*.ts" --include="*.vue" --include="*.js" | grep -v "node_modules"
   ```
   - Check for hardcoded secrets
   - Verify all secrets use environment variables

5. **Check authentication code**:
   - Search for auth code: `grep -r "signIn\|authenticate\|verifyToken" packages/app --include="*.ts"`
   - Verify:
     - Password hashing (should use Firebase Auth)
     - Token validation
     - Session management
     - MFA implementation (if present)

6. **Review OWASP Top 10**:
   - **Injection**: Check for SQL injection (N/A, using Firestore), XSS (check if inputs are escaped)
   - **Broken Auth**: Verify auth implementation
   - **Sensitive Data Exposure**: Check encryption (API keys should use AES-256-GCM)
   - **XXE**: N/A (no XML parsing)
   - **Broken Access Control**: Verify Firestore rules
   - **Security Misconfiguration**: Check for debug mode in production
   - **XSS**: Check Vue.js templates (should auto-escape)
   - **Insecure Deserialization**: Check JSON parsing
   - **Using Components with Known Vulnerabilities**: Dependency scan (step 2)
   - **Insufficient Logging**: Verify audit logs exist

7. **Prioritize findings**:
   - **Critical**: Secrets in code, broken auth, injection vulnerabilities
   - **High**: Overly permissive rules, missing encryption, known CVEs
   - **Medium**: Missing audit logs, outdated dependencies (no known CVE)
   - **Low**: Code quality issues, minor improvements

8. **Generate remediation plan**:
   - For each finding:
     - Vulnerability description
     - Impact (what could happen)
     - Remediation steps (how to fix)
     - Effort estimate (1 hour, 1 day, 1 week)
     - Deadline (based on severity)

9. **Create report**:
   - Write to `docs/security-scans/YYYY-MM-DD-vulnerability-scan.md`
   - Use template from agent README
   - Include:
     - Executive summary (# of vulns by severity)
     - Detailed findings
     - Remediation plan
     - Compliance impact (SOC 2 requirements)

10. **Create GitHub issues**:
    - Critical/High: Create issues immediately
    - Medium/Low: Batch into single issue
    - Label: `security`, `vulnerability`
    - Assign based on remediation plan

11. **Report to user**:
    - Summarize findings (don't bury critical issues!)
    - Highlight urgent actions
    - Link to full report
    - Link to GitHub issues

## Expected Duration

10-20 minutes (automated)

## Output Format

```markdown
üõ°Ô∏è Vulnerability Scan Complete - December 8, 2025

Summary:
- Critical: 0 ‚úÖ
- High: 2 ‚ö†Ô∏è
- Medium: 5
- Low: 12

Critical Issues:
(none)

High Priority (Fix This Week):
- Issue #126: Firestore rule allows cross-org data access in edge case (packages/app/firestore.rules:342)
- Issue #127: Outdated package with known XSS vulnerability (vue@3.2.0 ‚Üí 3.4.0)

Medium Priority (Fix This Month):
- 3 outdated dependencies (no known CVEs)
- 2 missing audit log entries

Low Priority (Nice to Have):
- 12 code quality improvements

Report: docs/security-scans/2025-12-08-vulnerability-scan.md
Next Steps: Fix high-priority issues first, then review medium/low

‚è∞ Next scan: December 15, 2025
```

## Notes

- Run weekly (every Monday) or on-demand
- Focus on actionable vulnerabilities (not false positives)
- If no vulns found, celebrate! (but still create report documenting clean scan)
- Integrate with GitHub Security (Dependabot) if available
- Consider adding SAST tools (Semgrep, CodeQL) in future
