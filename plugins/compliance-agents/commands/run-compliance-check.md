---
description: Run all compliance agents and generate a comprehensive report
---

# Run Compliance Check Command

Execute all compliance agents in sequence and generate a comprehensive compliance report.

## Instructions

1. **Pre-flight Check**:
   - Verify required environment variables are set (GITHUB_TOKEN, etc.)
   - Check that the `docs/` directory structure exists
   - Confirm Git is initialized and clean

2. **Run Each Agent**:
   Execute agents in order of priority:

   a. **Log Monitor** (quick, 5 min)
      - Use skill: `log-monitor`
      - Check for immediate security issues
      - If critical findings, alert immediately

   b. **Vulnerability Scanner** (15 min)
      - Use skill: `vulnerability-scan`
      - Scan dependencies and code
      - Create GitHub issues for findings

   c. **Policy Auditor** (30 min)
      - Use skill: `policy-audit`
      - Calculate SOC 2 readiness
      - Document compliance gaps

   d. **Access Reviewer** (if due - 15 min)
      - Check if quarterly review is due
      - Use skill: `access-review` if due
      - Skip if recently completed

   e. **DR Drill Runner** (if due - 2 hours)
      - Check if quarterly drill is due
      - Use skill: `dr-drill` if due
      - Skip if recently completed

3. **Aggregate Results**:
   After all agents complete, create a summary report:

```markdown
# Compliance Check Report
Date: [Current Date]
Duration: [Total Time]

## Summary
‚úÖ Agents Run: 5/5
‚ö†Ô∏è Critical Findings: [count]
üìä SOC 2 Readiness: [percentage]%

## Agent Results

### Log Monitor
- Status: ‚úÖ Complete
- Findings: [count by severity]
- Critical: [list]
- Report: docs/log-monitoring/[date].md

### Vulnerability Scanner
- Status: ‚úÖ Complete
- Dependencies scanned: [count]
- Vulnerabilities found: [count]
- Critical CVEs: [list]
- Report: docs/security-scans/[date].md

### Policy Auditor
- Status: ‚úÖ Complete
- SOC 2 Readiness: [percentage]%
- Controls Implemented: [count]/102
- Critical Gaps: [list]
- Report: docs/policy-audits/[date].md

### Access Reviewer
- Status: [Skipped/Complete]
- Users reviewed: [count]
- Action items: [count]
- Report: [if run]

### DR Drill Runner
- Status: [Skipped/Complete]
- RTO achieved: [if run]
- RPO achieved: [if run]
- Report: [if run]

## Action Items

Critical (Fix Immediately):
1. [Critical finding 1]
2. [Critical finding 2]

High Priority (This Week):
1. [High finding 1]
2. [High finding 2]

Medium Priority (This Month):
1. [Medium finding 1]

## GitHub Issues Created
- Issue #[num]: [title] (critical)
- Issue #[num]: [title] (high)

## Next Steps
1. Review and triage critical findings
2. Assign GitHub issues to owners
3. Schedule fixes based on priority
4. Next compliance check: [date]

---
Generated by Compliance Agents Plugin
```

4. **Post-Execution Actions**:
   - Commit reports to Git (if configured)
   - Send summary to Slack (if SLACK_WEBHOOK_URL set)
   - Create GitHub issues for findings
   - Output the summary report to console

5. **Error Handling**:
   - If an agent fails, document the failure but continue with others
   - Include failures in the summary report
   - Suggest remediation steps for failures

## Usage

```bash
# Run all checks
/run-compliance-check

# Or invoke conversationally
"Claude, run a full compliance check"
```

## Notes

- This command runs **all** agents, which can take 30-60 minutes
- For quick checks, use individual skills instead
- Agents that aren't due (quarterly/monthly) will be skipped
- All outputs are saved to `docs/` directories
